const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web-D57uMQ5G.js","assets/index-CRnbJmNt.js","assets/index-CHZleLHE.css","assets/BottomNav-C-NypWID.js","assets/BottomNav-CcdC5ZCT.css","assets/SelectionModal-B0T7TRaa.js"])))=>i.map(i=>d[i]);
import{j as h,_ as P,u as R,c as m,a as e,e as K,t as H,k,b as O,r as f,o as I,A as j}from"./index-CRnbJmNt.js";import{B as $}from"./BottomNav-C-NypWID.js";import{_ as g}from"./SelectionModal-B0T7TRaa.js";var c;(function(s){s.Aztec="AZTEC",s.Codabar="CODABAR",s.Code39="CODE_39",s.Code93="CODE_93",s.Code128="CODE_128",s.DataMatrix="DATA_MATRIX",s.Ean8="EAN_8",s.Ean13="EAN_13",s.Itf="ITF",s.Pdf417="PDF_417",s.QrCode="QR_CODE",s.UpcA="UPC_A",s.UpcE="UPC_E"})(c||(c={}));var l;(function(s){s.CalendarEvent="CALENDAR_EVENT",s.ContactInfo="CONTACT_INFO",s.DriversLicense="DRIVERS_LICENSE",s.Email="EMAIL",s.Geo="GEO",s.Isbn="ISBN",s.Phone="PHONE",s.Product="PRODUCT",s.Sms="SMS",s.Text="TEXT",s.Url="URL",s.Wifi="WIFI",s.Unknown="UNKNOWN"})(l||(l={}));var u;(function(s){s[s["640x480"]=0]="640x480",s[s["1280x720"]=1]="1280x720",s[s["1920x1080"]=2]="1920x1080",s[s["3840x2160"]=3]="3840x2160"})(u||(u={}));var _;(function(s){s.Front="FRONT",s.Back="BACK"})(_||(_={}));var C;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.PENDING=1]="PENDING",s[s.DOWNLOADING=2]="DOWNLOADING",s[s.CANCELED=3]="CANCELED",s[s.COMPLETED=4]="COMPLETED",s[s.FAILED=5]="FAILED",s[s.INSTALLING=6]="INSTALLING",s[s.DOWNLOAD_PAUSED=7]="DOWNLOAD_PAUSED"})(C||(C={}));var v;(function(s){s[s.HOME=0]="HOME",s[s.UNKNOWN=1]="UNKNOWN",s[s.WORK=2]="WORK"})(v||(v={}));var A;(function(s){s[s.HOME=0]="HOME",s[s.UNKNOWN=1]="UNKNOWN",s[s.WORK=2]="WORK"})(A||(A={}));var D;(function(s){s[s.FAX=0]="FAX",s[s.HOME=1]="HOME",s[s.MOBILE=2]="MOBILE",s[s.UNKNOWN=3]="UNKNOWN",s[s.WORK=4]="WORK"})(D||(D={}));var b;(function(s){s[s.OPEN=1]="OPEN",s[s.WEP=2]="WEP",s[s.WPA=3]="WPA"})(b||(b={}));const Q=h("BarcodeScanner",{web:()=>P(()=>import("./web-D57uMQ5G.js"),__vite__mapDeps([0,1,2,3,4,5])).then(s=>new s.BarcodeScannerWeb)}),M={class:"min-h-screen bg-slate-50 pb-24 relative"},X={class:"bg-[#84a96b] h-40 p-6 rounded-b-[3rem] flex items-start shadow-md"},z={class:"px-6 -mt-16"},S={class:"bg-white rounded-[2.5rem] shadow-xl shadow-slate-200 p-10 flex flex-col items-center border border-slate-50"},p={class:"text-2xl font-bold text-slate-800 text-center leading-tight"},V={class:"text-[#84a96b]"},q={__name:"HomeView",setup(s){const w=`${j}/api/scan`,o=R(),r=f(!1),N=f(""),x=["Traffic / Macet","Vehicle Trouble","Overslept","Rain / Hujan","Other"],d=async()=>{if(N.value="",!window.Capacitor?.isNativePlatform()){console.warn("Running in Browser: Simulating QR Scan..."),confirm("Simulate Successful Scan of 'CK-ENTRANCE-01'?")&&(r.value=!0);return}try{const n=await Q.scan();n?.barcodes?.length>0&&(n.barcodes[0].displayValue==="CK-ENTRANCE-01"?r.value=!0:alert("Unauthorized QR Code! Please scan the school entrance code."))}catch(n){console.error("Scan Error:",n),alert("Camera error. Please check permissions.")}},L=async()=>{const n=new Date,t=new Date;t.setHours(7,45,0);const i=n-t,E=i>0?Math.floor(i/6e4):0,W={student_id:o.user.student_id,reason:N.value,minutes_late:E};try{const a=await fetch(w,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(W)});if(a.ok)alert(`Recorded! You are ${E} mins late.`),await o.fetchHistory(),r.value=!1,N.value="";else{const U=await a.json();alert("Server Error: "+(U.error||"Failed to save record"))}}catch(a){console.error("Fetch Error:",a),alert("Network Error: Could not connect to the database server.")}};return(n,t)=>(I(),m("div",M,[e("div",X,[e("button",{onClick:t[0]||(t[0]=i=>n.$router.back()),class:"p-2 -ml-2"},[...t[3]||(t[3]=[e("i",{class:"fas fa-arrow-left text-white text-xl"},null,-1)])])]),e("div",z,[e("div",S,[e("h2",p,[t[4]||(t[4]=K(" Welcome,",-1)),t[5]||(t[5]=e("br",null,null,-1)),e("span",V,H(k(o).user.name||"Student"),1)]),e("button",{onClick:d,class:"mt-12 w-full max-w-55 bg-[#2d74da] text-white rounded-2xl py-5 flex items-center justify-center gap-4 shadow-lg shadow-blue-200 active:scale-95 transition-all"},[...t[6]||(t[6]=[e("i",{class:"fas fa-qrcode text-2xl"},null,-1),e("span",{class:"text-lg font-bold tracking-wide uppercase"},"Scan QR Code",-1)])])])]),O(g,{title:"Why are you late?",show:r.value,options:x,modelValue:N.value,"onUpdate:modelValue":t[1]||(t[1]=i=>N.value=i),onClose:t[2]||(t[2]=i=>r.value=!1),onSubmit:L},null,8,["show","modelValue"]),O($)]))}},T=Object.freeze(Object.defineProperty({__proto__:null,default:q},Symbol.toStringTag,{value:"Module"}));export{l as B,T as H,_ as L};
