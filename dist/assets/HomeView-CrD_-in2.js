const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web-C4sxq4_3.js","assets/index-DGdnMF_s.js","assets/index-CHZleLHE.css","assets/BottomNav-BIIP4tJs.js","assets/BottomNav-CcdC5ZCT.css","assets/SelectionModal-CzEgd4cX.js"])))=>i.map(i=>d[i]);
import{j as P,_ as R,u as h,c as K,a as e,e as H,t as I,k,b as f,r as E,o as j,A as g}from"./index-DGdnMF_s.js";import{B as $}from"./BottomNav-BIIP4tJs.js";import{_ as Q}from"./SelectionModal-CzEgd4cX.js";var l;(function(s){s.Aztec="AZTEC",s.Codabar="CODABAR",s.Code39="CODE_39",s.Code93="CODE_93",s.Code128="CODE_128",s.DataMatrix="DATA_MATRIX",s.Ean8="EAN_8",s.Ean13="EAN_13",s.Itf="ITF",s.Pdf417="PDF_417",s.QrCode="QR_CODE",s.UpcA="UPC_A",s.UpcE="UPC_E"})(l||(l={}));var c;(function(s){s.CalendarEvent="CALENDAR_EVENT",s.ContactInfo="CONTACT_INFO",s.DriversLicense="DRIVERS_LICENSE",s.Email="EMAIL",s.Geo="GEO",s.Isbn="ISBN",s.Phone="PHONE",s.Product="PRODUCT",s.Sms="SMS",s.Text="TEXT",s.Url="URL",s.Wifi="WIFI",s.Unknown="UNKNOWN"})(c||(c={}));var u;(function(s){s[s["640x480"]=0]="640x480",s[s["1280x720"]=1]="1280x720",s[s["1920x1080"]=2]="1920x1080",s[s["3840x2160"]=3]="3840x2160"})(u||(u={}));var _;(function(s){s.Front="FRONT",s.Back="BACK"})(_||(_={}));var v;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.PENDING=1]="PENDING",s[s.DOWNLOADING=2]="DOWNLOADING",s[s.CANCELED=3]="CANCELED",s[s.COMPLETED=4]="COMPLETED",s[s.FAILED=5]="FAILED",s[s.INSTALLING=6]="INSTALLING",s[s.DOWNLOAD_PAUSED=7]="DOWNLOAD_PAUSED"})(v||(v={}));var C;(function(s){s[s.HOME=0]="HOME",s[s.UNKNOWN=1]="UNKNOWN",s[s.WORK=2]="WORK"})(C||(C={}));var A;(function(s){s[s.HOME=0]="HOME",s[s.UNKNOWN=1]="UNKNOWN",s[s.WORK=2]="WORK"})(A||(A={}));var D;(function(s){s[s.FAX=0]="FAX",s[s.HOME=1]="HOME",s[s.MOBILE=2]="MOBILE",s[s.UNKNOWN=3]="UNKNOWN",s[s.WORK=4]="WORK"})(D||(D={}));var b;(function(s){s[s.OPEN=1]="OPEN",s[s.WEP=2]="WEP",s[s.WPA=3]="WPA"})(b||(b={}));const S=P("BarcodeScanner",{web:()=>R(()=>import("./web-C4sxq4_3.js"),__vite__mapDeps([0,1,2,3,4,5])).then(s=>new s.BarcodeScannerWeb)}),M={class:"min-h-screen bg-slate-50 pb-24 relative"},X={class:"bg-[#84a96b] h-40 p-6 rounded-b-[3rem] flex items-start shadow-md"},p={class:"px-6 -mt-16"},z={class:"bg-white rounded-[2.5rem] shadow-xl shadow-slate-200 p-10 flex flex-col items-center border border-slate-50"},q={class:"text-2xl font-bold text-slate-800 text-center leading-tight"},V={class:"text-[#84a96b]"},J={__name:"HomeView",setup(s){const w=`${g}/api/scan`,a=h(),r=E(!1),N=E(""),x=["Traffic / Macet","Vehicle Trouble","Overslept","Rain / Hujan","Other"],d=async()=>{if(N.value="",!window.Capacitor?.isNativePlatform()){console.warn("Running in Browser: Simulating QR Scan..."),confirm("Simulate Successful Scan of 'CK-ENTRANCE-01'?")&&(r.value=!0);return}try{const n=await S.scan();n?.barcodes?.length>0&&(n.barcodes[0].displayValue==="CK-ENTRANCE-01"?r.value=!0:alert("Unauthorized QR Code! Please scan the school entrance code."))}catch(n){console.error("Scan Error:",n),alert("Camera error. Please check permissions.")}},L=async()=>{const n=new Date,t=new Date;t.setHours(7,45,0);const i=n-t,O=i>0?Math.floor(i/6e4):0,W=n.toISOString().slice(0,19).replace("T"," "),U={student_id:a.user.student_id,reason:N.value,minutes_late:O,arrival_time:W};try{const o=await fetch(w,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(U)});if(o.ok)alert(`Recorded! You are ${O} mins late.`),await a.fetchHistory(),r.value=!1,N.value="";else{const m=await o.json();alert("Server Error: "+(m.error||"Failed to save record"))}}catch{alert("Network Error: Could not connect to the database server.")}};return(n,t)=>(j(),K("div",M,[e("div",X,[e("button",{onClick:t[0]||(t[0]=i=>n.$router.back()),class:"p-2 -ml-2"},[...t[3]||(t[3]=[e("i",{class:"fas fa-arrow-left text-white text-xl"},null,-1)])])]),e("div",p,[e("div",z,[e("h2",q,[t[4]||(t[4]=H(" Welcome,",-1)),t[5]||(t[5]=e("br",null,null,-1)),e("span",V,I(k(a).user.name||"Student"),1)]),e("button",{onClick:d,class:"mt-12 w-full max-w-55 bg-[#2d74da] text-white rounded-2xl py-5 flex items-center justify-center gap-4 shadow-lg shadow-blue-200 active:scale-95 transition-all"},[...t[6]||(t[6]=[e("i",{class:"fas fa-qrcode text-2xl"},null,-1),e("span",{class:"text-lg font-bold tracking-wide uppercase"},"Scan QR Code",-1)])])])]),f(Q,{title:"Why are you late?",show:r.value,options:x,modelValue:N.value,"onUpdate:modelValue":t[1]||(t[1]=i=>N.value=i),onClose:t[2]||(t[2]=i=>r.value=!1),onSubmit:L},null,8,["show","modelValue"]),f($)]))}},G=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));export{c as B,G as H,_ as L};
